<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FixaPro Premium</title>
  <link rel="manifest" href="#manifest-placeholder">
  <meta name="theme-color" content="#0055aa">
  <style>
    /* —Ç–æ—Ç –∂–µ CSS, —á—Ç–æ –∏ —Ä–∞–Ω—å—à–µ */
    * { margin:0; padding:0; box-sizing:border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    :root { --primary: #0055aa; --dark: #0a0a0a; --card: #151515; --text: #e0e0e0; }
    body { background: var(--dark); color: var(--text); padding: 16px; }
    #app { max-width: 1000px; margin: 0 auto; }
    .btn { display: block; width: 100%; padding: 16px; margin: 12px 0; background: var(--primary); color: white; border: none; border-radius: 14px; font-size: 18px; font-weight: 600; cursor: pointer; }
    .card { background: var(--card); padding: 18px; margin: 14px 0; border-radius: 16px; border-left: 4px solid var(--primary); }
    input[type="text"] { width: 100%; padding: 14px; margin: 12px 0; background: #222; border: 1px solid #444; border-radius: 12px; color: white; font-size: 16px; }
    .header { text-align: center; margin: 20px 0; }
    .header h1 { font-size: 28px; margin-bottom: 8px; }
    .status { text-align: center; color: #777; margin: 20px 0; font-size: 14px; }
  </style>
</head>
<body>
  <div id="app">–ó–∞–≥—Ä—É–∑–∫–∞ FixaPro Premium (10 000+ –º–æ–¥–µ–ª–µ–π)...</div>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ -->
  <script src="data/appliances.js"></script>
  <script src="data/medical.js"></script>
  
  <script>
    let currentView = 'home';

    function render() {
      let html = '';
      if (currentView === 'home') {
        html = `
          <div class="header">
            <h1>FixaPro Premium</h1>
            <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –±–∞–∑–∞: 10 000+ –º–æ–¥–µ–ª–µ–π, 80 000+ –±–æ–ª–µ–∑–Ω–µ–π</p>
          </div>
          <div class="card">
            <button class="btn" onclick="currentView='appliances'; render();">üîß –¢–µ—Ö–Ω–∏–∫–∞ (${APPLIANCES.length} –º–æ–¥–µ–ª–µ–π)</button>
            <button class="btn" onclick="currentView='medical'; render();">üè• –ú–µ–¥–∏—Ü–∏–Ω–∞ (${MEDICAL.length} –±–æ–ª–µ–∑–Ω–µ–π)</button>
            <button class="btn" onclick="useVoice()">üé§ –ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫</button>
            <button class="btn" onclick="alert('QR-—Å–∫–∞–Ω–µ—Ä: —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ Premium')">üì∏ –°–∫–∞–Ω–µ—Ä –º–æ–¥–µ–ª–∏</button>
          </div>
          <p class="status">–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.</p>
        `;
      } else if (currentView === 'appliances') {
        html = `
          <h2>–¢–µ—Ö–Ω–∏–∫–∞</h2>
          <input type="text" id="searchAppl" placeholder="–ü–æ–∏—Å–∫ –ø–æ –º–æ–¥–µ–ª–∏..." oninput="searchAppliances(this.value)" />
          <div id="results"></div>
          <button class="btn" onclick="currentView='home'; render();">‚Üê –ù–∞–∑–∞–¥</button>
        `;
        searchAppliances('');
      } else if (currentView === 'medical') {
        html = `
          <h2>–ú–µ–¥–∏—Ü–∏–Ω–∞ (–ú–ö–ë-11)</h2>
          <input type="text" id="searchMed" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—é..." oninput="searchMedical(this.value)" />
          <div id="results"></div>
          <button class="btn" onclick="currentView='home'; render();">‚Üê –ù–∞–∑–∞–¥</button>
        `;
        searchMedical('');
      }
      document.getElementById('app').innerHTML = html;
    }

    function searchAppliances(query) {
      const results = APPLIANCES.filter(item => 
        item.model.toLowerCase().includes(query.toLowerCase()) || 
        item.brand.toLowerCase().includes(query.toLowerCase())
      );
      renderResults(results, 'appl');
    }

    function searchMedical(query) {
      const results = MEDICAL.filter(item => 
        item.code.toLowerCase().includes(query.toLowerCase()) || 
        item.title_ru.toLowerCase().includes(query.toLowerCase())
      );
      renderResults(results, 'med');
    }

    function renderResults(results, type) {
      const container = document.getElementById('results');
      if (!results || results.length === 0) {
        container.innerHTML = '<p class="status">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>';
        return;
      }
      container.innerHTML = results.map(item => {
        if (type === 'appl') {
          return `<div class="card"><strong>${item.brand} ${item.model}</strong><br>–¢–∏–ø: ${item.type}<br>–û—à–∏–±–∫–∏: ${item.errors.join(', ')}</div>`;
        } else {
          return `<div class="card"><strong>${item.code} ‚Äî ${item.title_ru}</strong><br>${item.description_ru || ''}<br><small style="color:#ff6b6b;">${item.warning}</small></div>`;
        }
      }).join('');
    }

    function useVoice() {
      if (!('webkitSpeechRecognition' in window)) {
        alert('–ì–æ–ª–æ—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ Chrome –∏–ª–∏ Edge');
        return;
      }
      const rec = new webkitSpeechRecognition();
      rec.lang = 'ru-RU';
      rec.start();
      rec.onresult = (e) => {
        const text = e.results[0][0].transcript;
        if (currentView === 'appliances') {
          document.getElementById('searchAppl').value = text;
          searchAppliances(text);
        } else if (currentView === 'medical') {
          document.getElementById('searchMed').value = text;
          searchMedical(text);
        }
      };
    }

    // PWA manifest
    const manifest = {
      "name": "FixaPro Premium",
      "short_name": "FixaPro",
      "start_url": "/",
      "display": "standalone",
      "background_color": "#000000",
      "theme_color": "#0055aa",
      "icons": [{"src": "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üîß</text></svg>","sizes":"192x192","type":"image/svg+xml"}]
    };
    const manifestBlob = new Blob([JSON.stringify(manifest)], {type: 'application/json'});
    const manifestURL = URL.createObjectURL(manifestBlob);
    const link = document.createElement('link');
    link.rel = 'manifest';
    link.href = manifestURL;
    document.head.appendChild(link);

    // –ó–∞–ø—É—Å–∫
    document.addEventListener('DOMContentLoaded', () => {
      if (typeof APPLIANCES !== 'undefined' && typeof MEDICAL !== 'undefined') {
        render();
      } else {
        document.getElementById('app').innerHTML = '<div class="card"><h2>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</h2><p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª—ã data/appliances.js –∏ data/medical.js —Å—É—â–µ—Å—Ç–≤—É—é—Ç.</p></div>';
      }
    });
  </script>
</body>
</html>
